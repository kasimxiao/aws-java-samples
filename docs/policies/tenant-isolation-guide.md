# 多租户 S3 访问隔离方案

## 架构概述

```
┌─────────────────────────────────────────────────────────────┐
│                      SSM 命令执行                            │
│                    (挂载 S3 存储桶)                          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                     EC2 实例角色                             │
│              (绑定租户专属 IAM 策略)                         │
└─────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
      ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
      │ toolchain-   │ │ toolchain-   │ │ toolchain-   │
      │ tenant-001   │ │ tenant-002   │ │ shared       │
      │ (专属桶)     │ │ (专属桶)     │ │ (共享桶)     │
      └──────────────┘ └──────────────┘ └──────────────┘
```

## 隔离策略

### 方案一：租户专属存储桶

每个租户拥有独立的 S3 存储桶：
- `toolchain-tenant-001`
- `toolchain-tenant-002`

**优点**：完全隔离，便于管理和计费
**缺点**：存储桶数量多，管理成本高

### 方案二：共享存储桶 + 前缀隔离

所有租户共享一个存储桶，通过前缀隔离：
- `toolchain-shared/tenant-001/*`
- `toolchain-shared/tenant-002/*`

**优点**：管理简单，存储桶数量少
**缺点**：需要严格的策略控制

### 方案三：混合模式（推荐）

- 租户专属桶：存放敏感数据
- 共享桶：存放公共资源和租户隔离目录
